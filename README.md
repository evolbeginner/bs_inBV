# bs_inBV
A tool to help generate the file in.BV when using "complex" substitution models for MCMCTree. Particularly, the hessian is approximated by a bootstrap approach.


# Usage #
1. Perform a regular MCMCTree analysis. To save time, you can run with only the prior (e.g., set usedata = 0 in mcmctree.ctl) and very few iterations (set burnin=1, sampfreq=1, nsample=1 in mcmctree.ctl).
  The reason for this step is to make sure the order of the tips in the file in.BV generated by MCMCTree is the same as that of the species.tree specified by the user.

2. Extract a "reference" tree from the file in.BV generated by MCMCTree in the previous step.
  
  `sed '4!d' in.BV > ref.tre`

3. Run the following

  `ruby create_hessian_by_bootstrapping.rb --ali <alignment> --calibrated_tree <species_tree> --ref ref.tre --outdir C20 --force -b 1000 --cpu 8 -m LG+G+C20 --mcmctree_ctl mcmctree.ctl --run_mcmctree --pmsf`
# the above runs mcmctree (--run_mcmctree) directly after generating a C60-based in.BV. Note that w/o --pmsf it's much slower so PMSF is recommended and they seem to give highly similar time estimates (more work in validation needed though). #
